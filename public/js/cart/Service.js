define(["backbone","backbone.marionette"],function(t,e){var a=e.Object.extend({initialize:function(){if(localStorage.getItem("cart"))try{this._data=JSON.parse(localStorage.getItem("cart")),"object"!=typeof this._data&&(this._data={})}catch(e){this._data={}}else this._data={};this.model=new t.Model({count:this.count()})},_save:function(){localStorage.setItem("cart",this.serialize()),this.model.set("count",this.count())},serialize:function(){return JSON.stringify(this._data)},add:function(t,e){0===e?this.remove(t):(this._data[t]=e||1,this._save())},remove:function(t){delete this._data[t],this._save()},toggle:function(t){this.has(t)?this.remove(t):this.add(t)},count:function(){return Object.keys(this._data).length},has:function(t){return this._data.hasOwnProperty(t)},removeAll:function(){this._data={},this._save()}});return new a});